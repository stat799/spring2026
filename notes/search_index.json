[["index.html", "STAT 799 - Topics in Statistics: Applied linear mixed models in agriculture and life sciences Day 1 Welcome to STAT 799! 1.1 About this course: 1.2 Learning goals 1.3 On notation 1.4 Semester project 1.5 Roadmap of this course 1.6 Getting started with statistical modeling 1.7 Review 1.8 The most common statistical model 1.9 Uncertainty 1.10 Coming up tomorrow:", " STAT 799 - Topics in Statistics: Applied linear mixed models in agriculture and life sciences Josefina Lacasa Spring 2026 Day 1 Welcome to STAT 799! January 26th, 2026 1.1 About this course: About me About you: library(tidyverse) library(latex2exp) library(ggpubr) In rounds: What’s your major, what do you expect to learn? 1.1.1 Logistics Website Syllabus Statistical programming requirements Rough mindmap of the course (on whiteboard) Semester project Grades: Pass (100-69.99), Fail (&lt;69.99). Attendance policies Semester projects 1.2 Learning goals By the end of this course, you should be able to: Identify the data structure for a given dataset and write the statistical model that corresponds to said data structure using statistical notation. Distinguish the benefits and disadvantages of different modeling approaches. Write the Materials and Methods section in a paper (or graduate thesis) that describes the data generating process and the statistical model. 1.3 On notation scalars: \\(y\\), \\(\\sigma\\), \\(\\beta_0\\) vectors: \\(\\mathbf{y} \\equiv [y_1, y_2, ..., y_n]&#39;\\), \\(\\boldsymbol{\\beta} \\equiv [\\beta_1, \\beta_2, ..., \\beta_p]&#39;\\), \\(\\boldsymbol{u}\\) matrices: \\(\\mathbf{X}\\), \\(\\Sigma\\) probability distribution: \\(y \\sim N(0, \\sigma^2)\\), \\(\\mathbf{y} \\sim N(\\boldsymbol{0}, \\sigma^2\\mathbf{I})\\). 1.4 Semester project Manuscript See rubric on CANVAS. Publication-ready M&amp;M and results. Must include Abstract (250w), Introduction (~400-600w), M&amp;M (~300-700w), Results (~400w), Discussion (~300-500w), Conclusions (~100w). Last paragraph in the Introduction should clearly state the research gap and the research objectives. Reproducible Tutorial Publication-ready tutorial/R documentation. If you are not sure about your research question yet, talk to me after class today. 1.5 Roadmap of this course Table 1.1: Course Schedule: Statistical Modeling &amp; Mixed Models Date Topic Kahoot? 01/28 Statistical modeling. Continuous and categorical predictors. Review of mean, variance, and covariance. Types of uncertainty and sources of uncertainty. 01/29 Linear mixed models I. Model diagnostics and model selection. 01/30 Linear mixed models II. Model diagnostics and model selection. Yes Weekend NA NA 02/02 Analysis of variance. 02/03 Non-linear mixed models. 02/04 Troubleshooting in mixed models fitting using R software. Computational and analytical solutions. Yes 02/05 Generalized linear mixed models I. Beta, Binomial. 02/06 Statistical inference. Statistical power in designed experiments Weekend NA NA 02/09 Students are encouraged to attend Workshop ‘Non-linear models for the plant sciences’ 02/10 Students are encouraged to attend Workshop ‘Non-linear models for the plant sciences’ 02/11 Students are encouraged to attend Workshop ‘Non-linear models for the plant sciences’ 02/12 Scientific writing. Dos &amp; don’ts. 02/13 Wrap-up Yes 1.6 Getting started with statistical modeling Why do we need statistical models? Statistics as a summary of the data Excerpt from the short story “Funes the memorious” (J.L. Borges): I suspect, however, that he was not very capable of thought. To think is to forget differences, generalize, make abstractions. In the teeming world of Funes, there were only details, almost immediate in their presence. What is a statistical model? Deterministic component + Stochastic component 1.6.1 Writing a statistical model Deterministic component + Stochastic component Example: \\(y_i \\sim N(\\mu_i, \\sigma^2), \\\\ \\mu_i = \\beta_0 + \\beta_1 x_i\\) 1.6.2 What are linear models? Assume that \\(y_i \\sim N(\\mu_i, \\sigma^2)\\). …and there are 4 possible descriptions of the mean: \\(\\mu_i = \\beta_0 + \\beta_1 x_{1i} + \\beta_2 x_{2i}\\) \\(\\mu_i = \\beta_0 + \\beta_1 x_i + \\beta_2 x_i^2\\) \\(\\mu_i = \\beta_0 \\cdot \\exp(x_i \\cdot \\beta_1)\\) \\(\\mu_i = \\beta_0 + x_i^{\\beta_1}\\) What is a linear model and what is not? 1.6.3 Vectorized notation Model equation form: \\(y_i = \\beta_0 + \\beta_1 x_i + \\varepsilon_i\\) \\(\\varepsilon_i \\sim N(0, \\sigma^2),\\) Probability distribution form: Scalar \\(y_i \\sim N(\\mu_i, \\sigma^2),\\) \\(\\mu_i = \\beta_0 + \\beta_1 x_i\\) Vector \\(\\mathbf{y} \\sim N(\\boldsymbol{\\mu}, \\Sigma),\\) \\(\\boldsymbol{\\mu} = \\boldsymbol{1} \\beta_0 + \\mathbf{x} \\beta_1 = \\mathbf{X}\\boldsymbol{\\beta}\\) 1.6.4 Vectorized notation - cont. \\[\\begin{bmatrix}y_1 \\\\ y_2 \\\\ \\vdots \\\\ y_n \\end{bmatrix} \\sim N \\left( \\begin{bmatrix}\\mu_1 \\\\ \\mu_2 \\\\ \\vdots \\\\ \\mu_n \\end{bmatrix}, \\begin{bmatrix} Cov(y_1, y_1) &amp; Cov(y_1, y_2) &amp; \\dots &amp; Cov(y_1, y_n) \\\\ Cov(y_2, y_1) &amp; Cov(y_2, y_2) &amp; \\dots &amp; Cov(y_2, y_n)\\\\ \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\\\ Cov(y_n, y_1) &amp; Cov(y_n, y_2) &amp; \\dots &amp; Cov(y_n, y_n) \\end{bmatrix} \\right)\\] 1.6.5 Continuous and categorical predictors \\[\\mu_i = \\beta_0 + x_{1i} \\beta_1 + x_{2i} \\beta_2+ ... + x_{ji} \\beta_j\\] Discuss the following type of data: biomass cultivar county year 1.6.6 Three-step approach to writing a statistical model 1. What probability distribution function describes the data? Think about: type of data, support of the data. 2. Define a link function for the linear predictor. 3. Define the linear predictor. Treatments Design 1.7 Review 1.7.1 Probability distributions knitr::include_graphics(&quot;figures/distributions.png&quot;) 1.7.2 Mean, Variance Mean: the balancing point of a probability distribution Variance: dispersion of \\(y\\) What do these distributions mean in practice? 1.7.3 Covariance Covariance between two random variables means how the two random variables behave relative to each other. Essentially, it quantifies the relationship between their joint variability. The variance of a random variable is the covariance of a random variable with itself. Consider two variables \\(y1\\) and \\(y2\\) each with a variance of 1 and a covariance of 0.6. \\[\\begin{bmatrix}y_1 \\\\ y_2 \\end{bmatrix} \\sim MVN \\left( \\begin{bmatrix} 10 \\\\ 8 \\end{bmatrix} , \\begin{bmatrix}1 &amp; 0.6 \\\\ 0.6 &amp; 1 \\end{bmatrix} \\right),\\] where the means of \\(y_1\\) and \\(y_2\\) are 10 and 8, respectively, and their covariance structure is represented in the variance-covariance matrix. Remember: \\[\\begin{bmatrix}y_1 \\\\ y_2 \\end{bmatrix} \\sim MVN \\left( \\begin{bmatrix} E(y_1) \\\\ E(y_2) \\end{bmatrix} , \\begin{bmatrix} Var(y_1) &amp; Cov(y_1, y_2) \\\\ Cov(y_2,y_2) &amp; Var(y_2) \\end{bmatrix} \\right).\\] 1.8 The most common statistical model \\[\\mathbf{y} \\sim N(\\boldsymbol\\mu, \\boldsymbol\\Sigma),\\] where: \\(\\mathbf{y} \\equiv [y_1, y_2, \\dots, y_n]&#39;\\) contains the response data, \\(\\boldsymbol{\\mu} \\equiv [\\mu_1, \\mu_2, \\dots, \\mu_n]&#39;\\) contains the expected values of said data, \\(\\boldsymbol\\Sigma\\) is the variance-covariance matrix. The most typical model typically has: \\(\\boldsymbol\\mu = \\mathbf{X}\\boldsymbol{\\beta}\\) and \\(\\boldsymbol\\Sigma = \\sigma^2\\mathbf{I}\\). In summary, the assumptions are: Normality Independence Constant variance 1.8.1 Properties of the general linear model \\(E(\\hat{\\boldsymbol{\\beta}}) = \\boldsymbol{\\beta}\\) \\(\\text{Var}(\\hat{\\boldsymbol{\\beta}}) = \\frac{\\sigma^2}{\\mathbf{X}^T\\mathbf{X}} = \\sigma^2 (\\mathbf{X}^T\\mathbf{X})^{-1}\\) Class discussion: What if the observations weren’t independent? What if the variance wasn’t constant? 1.9 Uncertainty Uncertainty will be one of the central topics in this course. Uncertainty is important because, as we summarize the information (e.g., to aviod Funes’ useless excess of information), we can better describe all the information with a combination of the mean and the variance. 1.9.1 Types of uncertainty Epistemological uncertainty Intrinsic uncertainty 1.9.2 Types of uncertainty in the general linear model Recall \\(\\mathbf{y} \\sim N(\\boldsymbol{\\mu}, \\boldsymbol{\\Sigma})\\), where \\(\\boldsymbol{\\mu} = \\mathbf{X}\\boldsymbol{\\beta}\\), and suppose \\(\\boldsymbol{\\Sigma} = \\sigma^2 \\mathbf{I}\\). We use the estimator of \\(\\boldsymbol{\\beta}\\), \\(\\hat{\\boldsymbol{\\beta}}\\). \\(Var(\\mathbf{y}) = \\sigma^2 = \\frac{SSE}{df_e}\\), \\(Var(\\hat{\\boldsymbol{\\beta}}) = \\frac{\\sigma^2}{\\mathbf{X}^T\\mathbf{X}}\\), and \\(Var(\\hat\\beta_1) = \\frac{\\sigma^2}{(n-1)s^2_{x_1}}\\). Discuss the connection between \\(n\\), \\({df_e}\\), \\(\\sigma^2\\) and \\(Var(\\hat{\\boldsymbol{\\beta}})\\). 1.9.3 Uncertainty - applied example Assume that the model \\(y_i \\sim N(\\mu_i, \\sigma^2), \\mu_i = \\beta_0 + \\beta_1 x_i+ \\beta_2 x_i^2\\) describes the data generating process. url &lt;- &quot;https://raw.githubusercontent.com/k-state-id3a/mixed-models-fall25/refs/heads/newpart3/data/nitrogen_yield.csv&quot; df_n_ss &lt;- read.csv(url) m1 &lt;- lm(Yield_SY ~ Total_N + I(Total_N^2), data = df_n_ss) DHARMa::simulateResiduals(m1, plot = T) ## Object of Class DHARMa with simulated residuals based on 250 simulations with refit = FALSE . See ?DHARMa::simulateResiduals for help. ## ## Scaled residual values: 0.1 0.3 0.004 0.588 0.792 0.556 0.168 0.344 0.256 0.452 0.388 0.388 0.832 0.94 0.692 0.936 0.132 0.312 0.424 0.664 ... m1 &lt;- lm(Yield_SY ~ Total_N + I(Total_N^2), data = df_n_ss) df_plot &lt;- data.frame(Total_N = 0:280) df_plot$yhat &lt;- predict(m1, newdata = df_plot) # estimation uncertainty confid_est &lt;- predict(m1, newdata = df_plot, se.fit = TRUE, interval = &quot;confidence&quot;) df_plot$est_low &lt;- (confid_est$fit)[,2] df_plot$est_up &lt;- (confid_est$fit)[,3] # estimation uncertainty confid_pred &lt;- predict(m1, newdata = df_plot, se.fit = TRUE, interval = &quot;predict&quot;) df_plot$pred_low &lt;- (confid_pred$fit)[,2] df_plot$pred_up &lt;- (confid_pred$fit)[,3] df_plot |&gt; ggplot(aes(Total_N, yhat))+ geom_ribbon(aes(ymin = pred_low, ymax = pred_up), alpha = .3, fill = &quot;#B388EB&quot;)+ geom_ribbon(aes(ymin = est_low, ymax = est_up), alpha = .6, fill = &quot;#B200EB&quot;)+ geom_line()+ labs(y = latex2exp::TeX(&quot;$\\\\hat{y}$&quot;), x = expression(Total~N~(lb~ac^{-1})))+ theme_pubclean() 1.10 Coming up tomorrow: Reach Ch1 in Stroup et al. (2024) We start with mixed models "],["mixed-models-i.html", "Day 2 Mixed models I 2.1 Recall the most common statistical model 2.2 Variations to that very common statistical model 2.3 Relaxing the assumption of independence 2.4 Fixed effects and random effects 2.5 Generalities on mixed models 2.6 Applied examples 2.7 Coming up tomorrow:", " Day 2 Mixed models I January 27th, 2026 2.1 Recall the most common statistical model \\[\\mathbf{y} \\sim N(\\boldsymbol\\mu, \\boldsymbol\\Sigma),\\] where: \\(\\mathbf{y} \\equiv [y_1, y_2, \\dots, y_n]&#39;\\) contains the response data, \\(\\boldsymbol{\\mu} \\equiv [\\mu_1, \\mu_2, \\dots, \\mu_n]&#39;\\) contains the expected values of said data, \\(\\boldsymbol\\Sigma\\) is the variance-covariance matrix. The most typical model typically has: \\(\\boldsymbol\\mu = \\mathbf{X}\\boldsymbol{\\beta}\\) and \\(\\boldsymbol\\Sigma = \\sigma^2\\mathbf{I}\\). We can write the default model in most software written above as: \\[\\mathbf{y} \\sim N(\\boldsymbol{\\mu}, \\Sigma),\\\\ \\begin{bmatrix}y_1 \\\\ y_2 \\\\ y_3 \\\\ y_4 \\\\ \\vdots \\\\ y_n \\end{bmatrix} \\sim N \\left( \\begin{bmatrix}\\mu_1 \\\\ \\mu_2 \\\\ \\mu_3 \\\\ \\mu_4 \\\\ \\vdots \\\\ \\mu_n \\end{bmatrix}, \\sigma^2 \\begin{bmatrix} 1 &amp; 0 &amp; 0 &amp; 0 &amp; \\dots &amp; 0 \\\\ 0 &amp; 1 &amp; 0 &amp; 0 &amp; \\dots &amp; 0 \\\\ 0 &amp; 0 &amp; 1 &amp; 0 &amp; \\dots &amp; 0 \\\\ 0 &amp; 0 &amp; 0 &amp; 1 &amp; \\dots &amp; 0 \\\\ \\vdots &amp; \\vdots &amp; \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots\\\\ 0 &amp; 0 &amp; 0 &amp; 0 &amp; \\dots &amp; 1 \\end{bmatrix} \\right),\\] which is the same as \\[\\begin{bmatrix}y_1 \\\\ y_2 \\\\ y_3 \\\\ y_4 \\\\ \\vdots \\\\ y_n \\end{bmatrix} \\sim N \\left( \\begin{bmatrix}\\mu_1 \\\\ \\mu_2 \\\\ \\mu_3 \\\\ \\mu_4 \\\\ \\vdots \\\\ \\mu_n \\end{bmatrix}, \\begin{bmatrix} \\sigma^2 &amp; 0 &amp; 0 &amp; 0 &amp; \\dots &amp; 0 \\\\ 0 &amp; \\sigma^2 &amp; 0 &amp; 0 &amp; \\dots &amp; 0 \\\\ 0 &amp; 0 &amp; \\sigma^2 &amp; 0 &amp; \\dots &amp; 0 \\\\ 0 &amp; 0 &amp; 0 &amp; \\sigma^2 &amp; \\dots &amp; 0 \\\\ \\vdots &amp; \\vdots &amp; \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots\\\\ 0 &amp; 0 &amp; 0 &amp; 0 &amp; \\dots &amp; \\sigma^2 \\end{bmatrix} \\right).\\] In summary, the assumptions are: Linearity (or whatever the deterministic equation is) Normality Independence Constant variance 2.1.1 Types of predictors Quantitative predictors Just like yesterday: \\[y_{i} \\sim N(\\mu_i, \\sigma^2), \\\\ \\mu_i = \\beta_0 + x_{1i} \\beta_1 + x_{2i} \\beta_2,\\] and say that \\(y_{i}\\) is the observed value for the \\(i\\)th observation, \\(\\beta_0\\) is the intercept, \\(x_{1i}\\) if the \\(i\\)th observation of \\(x_1\\), \\(\\beta_1\\) is the expected increase in \\(y\\) for each unit increase of \\(x_1\\), \\(x_{2i}\\) if the \\(i\\)th observation of \\(x_2\\), \\(\\beta_2\\) is the expected increase in \\(y\\) for each unit increase of \\(x_2\\). Qualitative predictors Instead of a quantitative predictor, we could have a qualitative (or categorical) predictor. Let the qualitative predictor have two possible levels, A and B. We could use the same model as before, \\[y_{i} \\sim N(\\mu_i, \\sigma^2), \\\\ \\mu_i = \\beta_0 + x_i \\beta_1,\\] and say that \\(y_{i}\\) is the observed value for the \\(i\\)th observation, \\(\\beta_0\\) is the expected value for A, \\(x_i = 0\\) if the \\(i\\)th observation belongs to A, and \\(x_i = 1\\) if the \\(i\\)th observation belongs to B. That way, \\(\\beta_1\\) is the difference between A and B. If the categorical predictor has more than two levels, \\[y_{i} \\sim N(\\mu_i, \\sigma^2), \\\\ \\mu_i = \\beta_0 + x_{1i} \\beta_1 + x_{2i} \\beta_2+ ... + x_{ji} \\beta_j,\\] \\(y_{i}\\) is still the observed value for the \\(i\\)th observation, \\(\\beta_0\\) is the expected value for A (sometimes in designed experiments this level is a control), \\[x_{1i} = \\begin{cases} 1, &amp; \\text{if } \\text{Treatment is B} \\\\ 0, &amp; \\text{if } \\text{else} \\end{cases}, \\\\ x_{2i} = \\begin{cases} 1, &amp; \\text{if } \\text{Treatment is C} \\\\ 0, &amp; \\text{if } \\text{else} \\end{cases}, \\\\ \\\\ \\dots, \\\\ \\\\ x_{ji} = \\begin{cases} 1, &amp; \\text{if } \\text{Treatment is J} \\\\ 1, &amp; \\text{if } \\text{else} \\end{cases}. \\] That way, all \\(\\beta\\)s are the differences between the treatment and the control. 2.2 Variations to that very common statistical model We can adapt the assumptions one by one: Linearity – change the deterministic equation Normality – assume a different distribution Independence – implement a hierarchical/multi-level/mixed model that models the data that were generated together. Constant variance – model the variance/assume a different distribution where the mean and the variance are not independent. 2.3 Relaxing the assumption of independence What if we can model the variance-covariance matrix with something else that’s not \\(\\sigma^2 \\mathbf{I}\\)? This is a visualization of the classical, default statistical model: This is a visualization of what’s coming with mixed models: Example 1: Example 2: 2.4 Fixed effects and random effects In what follows, we have a small elaboration of what it means to model that “structure in the data” (i.e., the groups of similarly generated points). 2.4.1 Going from fixed effects to fixed+random effects The data below were generated by an experiment that tested 18 sorghum genotypes in a randomized complete block design. Discuss the treatment structure Discuss the design structure dat_blocked &lt;- agridat::omer.sorghum |&gt; filter(env == &quot;E3&quot;) str(dat_blocked) ## &#39;data.frame&#39;: 72 obs. of 4 variables: ## $ env : Factor w/ 6 levels &quot;E1&quot;,&quot;E2&quot;,&quot;E3&quot;,..: 3 3 3 3 3 3 3 3 3 3 ... ## $ rep : Factor w/ 4 levels &quot;R1&quot;,&quot;R2&quot;,&quot;R3&quot;,..: 1 1 1 1 1 1 1 1 1 1 ... ## $ gen : Factor w/ 18 levels &quot;G01&quot;,&quot;G02&quot;,&quot;G03&quot;,..: 1 2 3 4 5 6 7 8 9 10 ... ## $ yield: num 449 458 545 547 784 ... Now, remember that the blocks are supposed to indicate “groups of similar experimental units”. Said “groups of similar experimental units” means that the assumption of independence would be kind of a stretch. In reality, all observations from the same block (are supposed to) have something in common. It’s not reasonable to assume that the observations are independent, because observations from the same field have more in common than observations from different fields. They share more similar soil and, with that, a baseline fertility and yield. Basically, we expect the genotypes relative performance to be similar across fields, but the baseline (a.k.a., the intercept) to be field-specific. Then, we could say \\[y_{ij} = \\beta_{0j} + G_i + \\varepsilon_{ij}, \\\\ \\varepsilon_{ij} \\sim N(0, \\sigma^2),\\] where \\(\\beta_{0j}\\) is a block-specific intercept, and \\(G_i\\) is the genotype effect. Now, there are different ways to model that block-specific intercept. This is a big forking path in statistical modeling. All-fixed models estimate the effects of everything. Mixed-effects models indicate what is similar to what via random effects. Fixed effects We could define an all-fixed model, \\[y_{ij} = \\beta_{0j} + G_i + \\varepsilon_{ij}, \\\\ \\beta_{0j} = \\beta_0 + u_j \\\\ \\varepsilon_{ij} \\sim N(0, \\sigma^2),\\] where \\(u_j\\) is the effect of the \\(j\\)th block on the intercept (i.e., on the baseline). In this case, \\(u_j\\) is a fixed effect, which means it may be estimated via least squares estimation or maximum likelihood estimation. Under both least squares and maximum likelihood (assuming normal distribution), we may estimate the parameters by computing \\[\\hat{\\boldsymbol{\\beta}}_{ML} = (\\mathbf{X}^T\\mathbf{X})^{-1}\\mathbf{X}^T\\mathbf{y},\\] which yields the minimum variance unbiased estimate of \\(\\boldsymbol{\\beta}\\). We still have \\[\\boldsymbol{\\Sigma} = \\begin{bmatrix} \\sigma_{\\varepsilon}^2 &amp; 0 &amp; 0 &amp; 0 &amp; \\dots &amp; 0 \\\\ 0 &amp; \\sigma_{\\varepsilon}^2 &amp; 0 &amp; 0 &amp; \\dots &amp; 0 \\\\ 0 &amp; 0 &amp; \\sigma_{\\varepsilon}^2 &amp; 0 &amp; \\dots &amp; 0 \\\\ 0 &amp; 0 &amp; 0 &amp; \\sigma_{\\varepsilon}^2 &amp; \\dots &amp; 0 \\\\ \\vdots &amp; \\vdots &amp; \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots\\\\ 0 &amp; 0 &amp; 0 &amp; 0 &amp; \\dots &amp; \\sigma_{\\varepsilon}^2 \\end{bmatrix}\\]. m_fixed &lt;- lm(yield ~ gen + rep, data = dat_blocked) summary(m_fixed) ## ## Call: ## lm(formula = yield ~ gen + rep, data = dat_blocked) ## ## Residuals: ## Min 1Q Median 3Q Max ## -349.66 -81.58 -1.08 78.47 318.59 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 672.03 86.46 7.773 3.29e-10 *** ## genG02 -66.52 113.20 -0.588 0.559393 ## genG03 223.07 113.20 1.971 0.054201 . ## genG04 167.40 113.20 1.479 0.145336 ## genG05 61.05 113.20 0.539 0.591996 ## genG06 -267.20 113.20 -2.361 0.022111 * ## genG07 355.20 113.20 3.138 0.002826 ** ## genG08 159.53 113.20 1.409 0.164820 ## genG09 231.31 113.20 2.043 0.046198 * ## genG10 156.66 113.20 1.384 0.172393 ## genG11 146.29 113.20 1.292 0.202071 ## genG12 -42.87 113.20 -0.379 0.706453 ## genG13 243.18 113.20 2.148 0.036467 * ## genG14 1.06 113.20 0.009 0.992565 ## genG15 64.72 113.20 0.572 0.570007 ## genG16 22.81 113.20 0.201 0.841122 ## genG17 -296.66 113.20 -2.621 0.011534 * ## genG18 448.28 113.20 3.960 0.000233 *** ## repR2 -150.83 53.36 -2.827 0.006704 ** ## repR3 -85.66 53.36 -1.605 0.114592 ## repR4 -124.21 53.36 -2.328 0.023936 * ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 160.1 on 51 degrees of freedom ## Multiple R-squared: 0.6748, Adjusted R-squared: 0.5473 ## F-statistic: 5.291 on 20 and 51 DF, p-value: 7.64e-07 Random effects We could also assume that the effects of the \\(j\\)th block (i.e., \\(u_j\\)) arise from a random distribution. The most common assumption (and the default in most statistical software) is that \\[u_j \\sim N(0, \\sigma^2_b).\\] Now, we don’t estimate the effect, but the variance \\(\\sigma^2_b\\). Note that there are \\(J\\) levels of the random effects, meaning that a random effect is always categorical. Also, now \\[\\hat{\\boldsymbol{\\beta}}_{REML} = (\\mathbf{X}^T \\mathbf{V}^{-1} \\mathbf{X})^{-1}\\mathbf{X}^T \\mathbf{V}^{-1} \\mathbf{y},\\] where \\(\\mathbf{V} = Var(\\mathbf{y})\\) is the variance-covariance matrix of \\(\\mathbf{y}\\), including residual variance and random-effects variance. Note that this formula yields the same point estimate for \\(\\boldsymbol{\\beta}\\), but with a different confidence interval. Now, the variance-covariance matrix \\(\\boldsymbol{\\Sigma}\\) of the marginal distribution has changed. library(lme4) m_mixed &lt;- lmer(yield ~ gen + (1|rep), data = dat_blocked) summary(m_mixed) ## Linear mixed model fit by REML [&#39;lmerMod&#39;] ## Formula: yield ~ gen + (1 | rep) ## Data: dat_blocked ## ## REML criterion at convergence: 729.7 ## ## Scaled residuals: ## Min 1Q Median 3Q Max ## -1.99895 -0.58043 -0.01854 0.52108 1.92022 ## ## Random effects: ## Groups Name Variance Std.Dev. ## rep (Intercept) 2906 53.91 ## Residual 25627 160.09 ## Number of obs: 72, groups: rep, 4 ## ## Fixed effects: ## Estimate Std. Error t value ## (Intercept) 581.86 84.46 6.889 ## genG02 -66.52 113.20 -0.588 ## genG03 223.07 113.20 1.971 ## genG04 167.40 113.20 1.479 ## genG05 61.05 113.20 0.539 ## genG06 -267.20 113.20 -2.361 ## genG07 355.20 113.20 3.138 ## genG08 159.53 113.20 1.409 ## genG09 231.31 113.20 2.043 ## genG10 156.66 113.20 1.384 ## genG11 146.29 113.20 1.292 ## genG12 -42.87 113.20 -0.379 ## genG13 243.18 113.20 2.148 ## genG14 1.06 113.20 0.009 ## genG15 64.72 113.20 0.572 ## genG16 22.81 113.20 0.201 ## genG17 -296.66 113.20 -2.621 ## genG18 448.28 113.20 3.960 ## ## Correlation matrix not shown by default, as p = 18 &gt; 12. ## Use print(x, correlation=TRUE) or ## vcov(x) if you need it 2.5 Generalities on mixed models Mixed models combine fixed effects and random effects. Generally speaking, we can write out a mixed-effects model using the model equation form, as \\[\\mathbf{y} = \\mathbf{X} \\boldsymbol{\\beta} + \\mathbf{Z}\\mathbf{u} + \\boldsymbol{\\varepsilon}, \\\\ \\begin{bmatrix}\\mathbf{u} \\\\ \\boldsymbol{\\varepsilon} \\end{bmatrix} \\sim \\left( \\begin{bmatrix}\\boldsymbol{0} \\\\ \\boldsymbol{0} \\end{bmatrix}, \\begin{bmatrix}\\mathbf{G} &amp; \\boldsymbol{0} \\\\ \\boldsymbol{0} &amp; \\mathbf{R} \\end{bmatrix} \\right),\\] where \\(\\mathbf{y}\\) is the observed response, \\(\\mathbf{X}\\) is the matrix with the explanatory variables, \\(\\mathbf{Z}\\) is the design matrix, \\(\\boldsymbol{\\beta}\\) is the vector containing the fixed-effects, \\(\\mathbf{u}\\) is the vector containing the random effects, \\(\\boldsymbol{\\varepsilon}\\) is the vector containing the residuals, \\(\\mathbf{G}\\) is the variance-covariance matrix of the random effects, and \\(\\mathbf{R}\\) is the variance-covariance matrix of the residuals. Note that \\(\\mathbf{X} \\boldsymbol{\\beta}\\) is the fixed effects part of the model, and \\(\\mathbf{Z}\\mathbf{u}\\) is the random effects part of the model. Using the probability distribution form, we can then say that \\(E(\\mathbf{y}) = \\mathbf{X}\\boldsymbol{\\beta}\\) and \\(Var(\\mathbf{y}) = \\mathbf{V} = \\mathbf{Z}\\mathbf{G}\\mathbf{Z}&#39; + \\mathbf{R}\\). Usually, we assume \\[\\mathbf{G} = \\sigma^2_u \\begin{bmatrix} 1 &amp; 0 &amp; 0 &amp; \\dots 0 \\\\ 0 &amp; 1 &amp; 0 &amp; \\dots &amp; 0 \\\\ 0 &amp; 0 &amp; 1 &amp; \\dots &amp; 0 \\\\ \\vdots &amp; \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\\\ 0 &amp; 0 &amp; 0 &amp; \\dots &amp; 1 \\end{bmatrix}\\] and \\[\\mathbf{R} = \\sigma^2 \\begin{bmatrix} 1 &amp; 0 &amp; 0 &amp; \\dots &amp; 0 \\\\ 0 &amp; 1 &amp; 0 &amp; \\dots &amp; 0 \\\\ 0 &amp; 0 &amp; 1 &amp; \\dots &amp; 0 \\\\ \\vdots &amp; \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\\\ 0 &amp; 0 &amp; 0 &amp; \\dots &amp; 1 \\end{bmatrix} \\]. Then, \\[\\mathbf{y} \\sim N(\\boldsymbol{\\mu}, \\Sigma), \\\\ \\Sigma = \\begin{bmatrix} \\sigma^2 + \\sigma^2_u &amp; \\sigma^2_u &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp;\\dots &amp; 0\\\\ \\sigma^2_u &amp; \\sigma^2 + \\sigma^2_u &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \\dots &amp; 0 \\\\ 0 &amp; 0 &amp; \\sigma^2 + \\sigma^2_u &amp; \\sigma^2_u &amp; 0 &amp; 0 &amp; \\dots &amp; 0 \\\\ 0 &amp; 0 &amp; \\sigma^2_u &amp; \\sigma^2 + \\sigma^2_u &amp; 0 &amp; 0 &amp; \\dots &amp; 0 \\\\ 0 &amp; 0 &amp; 0 &amp; 0 &amp; \\sigma^2 + \\sigma^2_u &amp; \\sigma^2_u &amp; \\dots &amp; 0 \\\\ 0 &amp; 0 &amp; 0 &amp; 0 &amp; \\sigma^2_u &amp; \\sigma^2 + \\sigma^2_u &amp; \\dots &amp; \\vdots \\\\ \\vdots &amp; \\vdots &amp; \\vdots &amp; \\vdots &amp; \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\\\ 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \\dots &amp; \\sigma^2 + \\sigma^2_u \\end{bmatrix}.\\] Take your time to digest the variance-covariance matrix above. What type of data do you think generated it? 2.5.1 Random effects By definition, random effects are regression coefficients that arise from a random distribution. Typically, a random effect \\(u \\sim N(0, \\sigma^2_u)\\). Note that this model for the parameter may result in shrinkage. We estimate the variance \\(\\sigma^2_u\\). Calculating degrees of freedom can get much more complex than in all-fixed effects models (e.g., with unbalanced data, spatio-temporally correlated data, or non-normal data). In the context of designed experiments, random effects are assumed to be independent to each other and independent to the residual. 2.5.2 Estimation of parameters “Estimation” is a term held mostly exclusive to fixed effects and variance components. Restricted maximum likelihood estimation (REML) is the default in most mixed effects models because, for small data (aka most experimental data), maximum likelihood (ML) provides variance estimates that are downward biased. - In REML, the likelihood is maximized after accounting for the model’s fixed effects. In ML, \\(\\ell_{ML}(\\boldsymbol{\\sigma; \\boldsymbol{\\beta}, \\mathbf{y}}) = - (\\frac{n}{2}) \\log(2\\pi)-(\\frac{1}{2}) \\log ( \\vert \\mathbf{V}(\\boldsymbol\\sigma) \\vert ) - (\\frac{1}{2}) (\\mathbf{y}-\\mathbf{X}\\boldsymbol{\\beta})^T[\\mathbf{V}(\\boldsymbol\\sigma)]^{-1}(\\mathbf{y}-\\mathbf{X}\\boldsymbol{\\beta})\\) In REML, \\(\\ell_{REML}(\\boldsymbol{\\sigma};\\mathbf{y}) = - (\\frac{n-p}{2}) \\log (2\\pi) - (\\frac{1}{2}) \\log ( \\vert \\mathbf{V}(\\boldsymbol\\sigma) \\vert ) - (\\frac{1}{2})log \\left( \\vert \\mathbf{X}^T[\\mathbf{V}(\\boldsymbol\\sigma)]^{-1}\\mathbf{X} \\vert \\right) - (\\frac{1}{2})\\mathbf{r}[\\mathbf{V}(\\boldsymbol\\sigma)]^{-1}\\mathbf{r}\\), where \\(p = rank(\\mathbf{X})\\), \\(\\mathbf{r} = \\mathbf{y}-\\mathbf{X}\\hat{\\boldsymbol{\\beta}}_{ML}\\). Start with initial values for \\(\\boldsymbol{\\sigma}\\), \\(\\tilde{\\boldsymbol{\\sigma}}\\). Compute \\(\\mathbf{G}(\\tilde{\\boldsymbol{\\sigma}})\\) and \\(\\mathbf{R}(\\tilde{\\boldsymbol{\\sigma}})\\). Obtain \\(\\boldsymbol{\\beta}\\) and \\(\\mathbf{b}\\). Update \\(\\tilde{\\boldsymbol{\\sigma}}\\). Repeat until convergence. 2.5.3 Fixed effects versus random effects What is behind a random effect: $ N ( , (^T ^{-1} )^{-1} ) $ \\(u_j \\sim N(0, \\sigma^2_u)\\) What process is being studied? How were the levels selected? (randomly, carefully selected) How many levels does the factor have, vs. how many did we observe? BLUEs versus BLUPs. Read more in in Gelman (2005, page 20), “Analysis of variance—why it is more important than ever” [link], and Gelman and Hill (2006), page 245. 2.6 Applied examples Three sets of data describe the relationship between treatment and crop yield. However, the structures in the data (i.e., data architecture) are different. 2.6.1 Example A – independence holds dat_independent &lt;- read.csv(&quot;../data/cochrancox_kfert.csv&quot;) m_independent &lt;- lm(yield ~ factor(K2O_lbac), data = dat_independent) 2.6.2 Example B – simple groups of similar observations library(lme4) dat_blocked &lt;- agridat::omer.sorghum |&gt; filter(env == &quot;E3&quot;) m_blocked &lt;- lmer(yield ~ gen + (1|rep), data = dat_blocked) 2.6.3 Example C – different groups of similar observations dat_multilevel &lt;- agridat::durban.splitplot m_multilevel &lt;- lmer(yield ~ gen*fung + (1|block/fung), data = dat_multilevel) 2.7 Coming up tomorrow: Review on mixed models Model diagnostics and model comparison Kahoot "],["semester-project-1.html", "Day 3 Semester Project 3.1 Learning objectives 3.2 Partial deadlines", " Day 3 Semester Project Semester projects may deal with any topic that interests you [the student], as long as it is approved by the instructor. Broadly, projects are expected to identify a research problem and develop a designed experiment that is appropriate for solving that problem. Projects consist of a manuscript and a tutorial that describes the research problem, the experiment design and the treatment design. 3.1 Learning objectives Apply content learned in class in a real-life problem, connected to the student’s research program, including: Writing the materials and methods section of a paper using statistical notation. Writing detailed supporting material that clearly connects R code with statistical models. Interpret the results from the statistical model and connect them to the real-life problem. 3.2 Partial deadlines 3.2.1 Project proposal - Due Sunday February 1st at noon CT Write a 1 or 2 page-long project proposal that (a) includes the background of your problem (i.e., why is this important?) and (b) states your research objective. 3.2.2 Written report - Due Wednesday April 20 at 2pm CT for peer review Submit a manuscript to one of your classmates. The manuscript must include Abstract (250w), Introduction (~500w), M&amp;M (~300-500w), Results (~400w), Discussion (~400w), Conclusions (~100w). 3.2.3 Oral presentation - Somewhere between May 1 - May 9 Prepare a 15 minute presentation of the core aspects of your project. Presentations should include at least: Motivation/Background Methods, including a clear and complete description of the statistical model and code Discussion of strengths and weaknesses Conclusions 3.2.4 Written report and reproducible tutorial - Due May 15 Manuscript must include a publication-ready analysis. Must include Abstract (250w), Introduction (~500w), M&amp;M (~300-500w), Results (~400w), Discussion (~400w), Conclusions (~100w). Last paragraph in the Introduction should clearly state the research gap and the research objectives. Publication-ready tutorial/R documentation See evaluation rubric on Canvas. "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
